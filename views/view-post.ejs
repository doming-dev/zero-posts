<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel='stylesheet' href="/styles/main.css">
    <link rel='stylesheet' href="/styles/nav.css">
    <link rel='stylesheet' href="/styles/view-post.css">
    <title><%=post.title%></title>
</head>
<body>
    <%- include('nav.ejs') %>
    <main>
        <div class="header-container">
            <h1 class="title"><%= post.title %></h1>
            <div class="meta-container">
                <img class="upvotes-icon" src="/heart-neutral-up.png" alt="upvote ico">
                <p class="meta-text"><%= post.meta.upvotes %> </p>
        
                <img class="downvotes-icon" src="/heart-neutral-down.png" alt="downvote ico">
                <p class="meta-text"><%= post.meta.downvotes %> </p>
        
                <img class="comments-icon" src="/comment.png" alt="comment ico">
                <p class="meta-text"><%= post.comments.length %> Comments</p>
            </div>
        </div>

        <h4 class="author">Author: <%= post.author %> </h3>
        <h4 class="date">Published: <%= post.createDate.toLocaleDateString()%></h4>
        <p class="body"><%= post.body %> </p>
    </main>

    <form class="comment-form" method="POST" action="add-comment">
        <textarea class="comment-area" placeholder="Add a comment.."></textarea>
        <button class="btn-comment" type="submit">Add Comment</button>    
    </form>

    <% if(post.comments.length > 0) { %>
        <% for(let comment of post.comments) {%>
            <div class="comment-container">
                <p>author: <%= comment.author %> author</p>
                <p> <%= comment.createDate %> date </p>

                <div class="meta-container">
                    <img class="upvotes-icon" src="/heart-neutral-up.png" alt="upvote ico">
                    <p class="meta-text"><%= comment.upvotes %> </p>
            
                    <img class="downvotes-icon" src="/heart-neutral-down.png" alt="downvote ico">
                    <p class="meta-text"><%= comment.downvotes %> </p>    
                </div>
    
                <p><%= comment.caption %></p>
            </div>
        <% } %>
    <% } %>
</body>
</html>